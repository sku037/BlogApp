@page "/edit-blog/{BlogId:int}"
@inject BlogService BlogService
@inject NavigationManager NavigationManager
@using BlogApp.BlazorServer.Models
@using BlogApp.BlazorServer.Services

<h3>Edit Blog</h3>

@if (blog == null)
{
    <p>Loading...</p>
}
else
{
    <EditForm Model="@blog" OnValidSubmit="@HandleSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group">
            <label for="title">Title:</label>
            <InputText id="title" class="form-control" @bind-Value="blog.Title" />
        </div>

        <div class="form-group">
            <label for="description">Description:</label>
            <InputTextArea id="description" class="form-control" @bind-Value="blog.Description" />
        </div>

        <button type="submit" class="btn btn-success">Save Changes</button>
    </EditForm>
}

@code {
    [Parameter]
    public int BlogId { get; set; }

    private Blog blog;

    protected override async Task OnInitializedAsync()
    {
        blog = await BlogService.GetBlog(BlogId);
    }

    private async Task HandleSubmit()
    {
        await BlogService.UpdateBlog(BlogId, blog);
        NavigationManager.NavigateTo("/");
    }
}